.. _dwiproc:

.. title:: DWI

Diffusion-weighted imaging processing
============================================================

DESCRIBE DWI PROC HERE


-proc_dwi
--------------------------------------------------------

Proc-dwi description

.. admonition:: Prerequisites üñêüèº

    You need to run **proc_structural** before this stage

.. tabs::

    .. tab:: Processing steps
    
        - DWI denoise, bias filed correction and concatenation
        - DWI FSL preprocessing 
        - TOPUP ?
        - Registering corrected DWI-b0 to T1nativepro (transformation and inverse transformation)
        - Creating a DWI binary mask of processed volumes
        - Registering 5TT file to DWI-b0 space
        - Calculating basic DTI metrics
        - Calculating multi-shell multi-tissue, response function and fiber orientation distribution
        - QC of the tractography

    .. tab:: Usage

        .. parsed-literal:: 
            $ mica-pipe **-sub** <subject_id> **-out** <outputDirectory> **-bids** <BIDS-directory> **-proc_dwi**

        Docker command:

        .. parsed-literal:: 
            $ docker -proc_dwi

        Singularity command: 

        .. parsed-literal:: 
            $ singularity -proc_dwi 
    
    .. tab:: Outputs

        Directories created or populated by **-proc_dwi**:

        .. parsed-literal:: 

            - <outputDirectory>/micapipe/dwi
            - <outputDirectory>/micapipe/dwi/eddy
            - <outputDirectory>/micapipe/xfms

        Files generated by **-proc_dwi**:

        .. parsed-literal:: 
            - 

    .. tab:: -slim        

        Files conserved during **-proc_dwi** slim run

        .. parsed-literal:: 
            - ...
                    

-SC
--------------------------------------------------------

post-dwi description

.. admonition:: Prerequisites üñêüèº

    You need to run **proc_structural**, **proc_freesurfer**, **post_structural**, and **-proc_dwi** before this stage

.. tabs::

    .. tab:: Processing steps
    
        - Post tractography and connectome generation
        - Registering Cerebellua parcellation to DWI-b0 space
        - Registering Subcortical parcellation to DWI-b0 space
        - Building the tracts streamlines connectomes
        - Building the cortical-subcortical connectomes
        - Building the cortical connectomes 
        - Building the cortical-subcortical-cerebellar connectomes
        - Calculate the edge lenghts
        - QC of the tractogram 

    .. tab:: Usage

        .. parsed-literal:: 
            $ mica-pipe **-sub** <subject_id> **-out** <outputDirectory> **-bids** <BIDS-directory> **-SC**

        Docker command:

        .. parsed-literal:: 
            $ docker -SC

        Singularity command: 

        .. parsed-literal:: 
            $ singularity -SC
    
    .. tab:: Outputs

        Directories created or populated by **-SC**:

        .. parsed-literal:: 

            - <outputDirectory>/micapipe/dwi
            - <outputDirectory>/micapipe/dwi/connectomes

        Files generated by **-SC**:

        .. parsed-literal:: 
            - 

    .. tab:: -slim

        Files conserved during **-SC** slim run

        .. parsed-literal:: 
            - ...
