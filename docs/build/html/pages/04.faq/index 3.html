

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Frequent Asked Questions &mdash; micapipe  documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/segment.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/menu.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/semantic-ui-2.4.1/tab.min.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/sphinx_tabs/tabs.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/mica-pipe_colors.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Citing micapipe" href="../06.citingmicapipe/index.html" />
    <link rel="prev" title="Building gradients" href="../04.gradients/index.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #261F4A" >
          

          
            <a href="../../index.html">
          

          
            
            <img src="../../_static/html_logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../01.install/index.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01.whatyouneed/index.html">Usages Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01.execution/index.html">Micapipe usage overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01.whatsnew/index.html">What’s new?</a></li>
</ul>
<p class="caption"><span class="caption-text">Processing modules</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../02.structuralproc/index.html">Structural processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.dwiproc/index.html">Diffusion-weighted imaging processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.restingstateproc/index.html">Resting-state fMRI processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.microstructproc/index.html">Microstructural profile covariance</a></li>
<li class="toctree-l1"><a class="reference internal" href="../02.qc/index.html">Quality control</a></li>
</ul>
<p class="caption"><span class="caption-text">Additional tools</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../05.mic2bids/index.html">From DICOMS to BIDS: <code class="docutils literal notranslate"><span class="pre">mic2bids</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../05.micapipe_cleanup/index.html"><code class="docutils literal notranslate"><span class="pre">micapipe_cleanup</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../05.micapipe_anonymize/index.html"><code class="docutils literal notranslate"><span class="pre">micapipe_anonymize</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../05.autotract/index.html">Automatic Bundle Segmentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../04.databases/index.html">Processing databases with <code class="docutils literal notranslate"><span class="pre">micapipe</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../04.matrices/index.html">Main output matrices</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04.surfaces/index.html">Surface visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../04.gradients/index.html">Building gradients</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#registration-issues">Registration issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="#surface-issues">Surface issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="#resting-state-issues">Resting state issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dwi-issues">DWI issues</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parcellation-issues">Parcellation issues</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">References &amp; Acknowledgements</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../06.citingmicapipe/index.html">Citing micapipe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06.references/index.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../06.acknowledge/index.html">Acknowlegdements</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">micapipe</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Frequent Asked Questions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/pages/04.faq/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="faq">
<span id="faqa"></span><h1><a class="toc-backref" href="#id10">FAQ</a><a class="headerlink" href="#faq" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#faq" id="id10">FAQ</a></p>
<ul>
<li><p><a class="reference internal" href="#registration-issues" id="id11">Registration issues</a></p></li>
<li><p><a class="reference internal" href="#surface-issues" id="id12">Surface issues</a></p></li>
<li><p><a class="reference internal" href="#resting-state-issues" id="id13">Resting state issues</a></p></li>
<li><p><a class="reference internal" href="#dwi-issues" id="id14">DWI issues</a></p></li>
<li><p><a class="reference internal" href="#parcellation-issues" id="id15">Parcellation issues</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="registration-issues">
<h2><a class="toc-backref" href="#id11">Registration issues</a><a class="headerlink" href="#registration-issues" title="Permalink to this headline">¶</a></h2>
<dl>
<dt>Q: How do I register a volume from rsfMRI or DWI space to MNI152 and vice-versa?</dt><dd><p><strong>A:</strong> although micapipe calculates all the necessary transformation matrices and warp fields to register from any native space to MNI152,
this procedure is not implemented at any point in the pipeline.</p>
<p>Using the following information you should be able to register between any spaces using ANTs.
The paths are relative to the subject directory (e.g. <code class="docutils literal notranslate"><span class="pre">out/micapipe/sub-01/ses-01</span></code>)</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Map from MNI152 0.8mm space to DWI native space</span><a class="headerlink" href="#id1" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Subjects identification</span>
<span class="nv">subjectID</span><span class="o">=</span>sub-01_ses-01

<span class="c1"># Map from MNI152 0.8mm to DWI space</span>
<span class="nv">Input</span><span class="o">=</span>file_in_space-MNI152_0.8mm.nii.gz
<span class="nv">Output</span><span class="o">=</span>file_from_MNI152_0.8mm_in_space-dwi.nii.gz

antsApplyTransforms -d <span class="m">3</span> -i <span class="si">${</span><span class="nv">Input</span><span class="si">}</span> <span class="se">\</span>
          -r dwi/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_space-dwi_desc-b0.nii.gz <span class="se">\</span>
          -n GenericLabel <span class="se">\ </span>  <span class="c1"># Interpolation!</span>
          -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_space-dwi_from-dwi_to-dwi_mode-image_desc-SyN_1Warp.nii.gz <span class="se">\</span>
          -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_space-dwi_from-dwi_to-dwi_mode-image_desc-SyN_0GenericAffine.mat <span class="se">\</span>
          -t <span class="o">[</span>xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_space-dwi_from-dwi_to-nativepro_mode-image_desc-0GenericAffine.mat,1<span class="o">]</span> <span class="se">\</span>
          -t <span class="o">[</span>xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_from-nativepro_brain_to-MNI152_0.8mm_mode-image_desc-SyN_0GenericAffine.mat,1<span class="o">]</span> <span class="se">\</span>
          -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_from-nativepro_brain_to-MNI152_0.8mm_mode-image_desc-SyN_1InverseWarp.nii.gz <span class="se">\</span>
          -o <span class="si">${</span><span class="nv">Output</span><span class="si">}</span> -v
</pre></div>
</td></tr></table></div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Map from DWI native space to MNI152 0.8mm</span><a class="headerlink" href="#id2" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Map from DWI space to MNI152 0.8mm</span>
<span class="nv">Input</span><span class="o">=</span>file_in_space-dwi.nii.gz
<span class="nv">Output</span><span class="o">=</span>file_from_dwi_in_space-MNI152_0.8mm.nii.gz

antsApplyTransforms -d <span class="m">3</span> -i <span class="si">${</span><span class="nv">Input</span><span class="si">}</span> <span class="se">\</span>
          -r <span class="si">${</span><span class="nv">MICAPIPE_DIR</span><span class="si">}</span>/MNI152Volumes/MNI152_T1_0.8mm_brain.nii.gz <span class="se">\</span>
          -n GenericLabel <span class="se">\</span>
          -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_from-nativepro_brain_to-MNI152_0.8mm_mode-image_desc-SyN_1Warp.nii.gz <span class="se">\</span>
          -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_from-nativepro_brain_to-MNI152_0.8mm_mode-image_desc-SyN_0GenericAffine.mat <span class="se">\</span>
          -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_space-dwi_from-dwi_to-nativepro_mode-image_desc-0GenericAffine.mat <span class="se">\</span>
          -t <span class="o">[</span>xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_space-dwi_from-dwi_to-dwi_mode-image_desc-SyN_0GenericAffine.mat,1<span class="o">]</span> <span class="se">\</span>
          -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_space-dwi_from-dwi_to-dwi_mode-image_desc-SyN_1Warp.nii.gz <span class="se">\</span>
          -o <span class="si">${</span><span class="nv">Output</span><span class="si">}</span> -v
<span class="o">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">From MNI152 to rsfMRI space</span><a class="headerlink" href="#id3" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Map from MNI152 0.8mm to rsfMRI space</span>
<span class="nv">Input</span><span class="o">=</span>file_in_space-MNI152_0.8mm.nii.gz
<span class="nv">Output</span><span class="o">=</span>file_from_MNI152_0.8mm_in_space-rsfMRI.nii.gz

antsApplyTransforms -d <span class="m">3</span> <span class="se">\</span>
    -i <span class="si">${</span><span class="nv">Input</span><span class="si">}</span> <span class="se">\</span>
    -r func/volumetric/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_space-rsfmri_desc-singleecho_brain.nii.gz <span class="se">\</span>
    -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_rsfmri_from-nativepro_rsfmri_to-rsfmri_mode-image_desc-SyN_1Warp.nii.gz <span class="se">\</span>
    -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_rsfmri_from-nativepro_rsfmri_to-rsfmri_mode-image_desc-SyN_0GenericAffine.mat <span class="se">\</span>
    -t <span class="o">[</span>xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_rsfmri_from-rsfmri_to-nativepro_mode-image_desc-affine_0GenericAffine.mat,1<span class="o">]</span> <span class="se">\</span>
    -t <span class="o">[</span>xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_from-nativepro_brain_to-MNI152_0.8mm_mode-image_desc-SyN_0GenericAffine.mat,1<span class="o">]</span> <span class="se">\</span>
    -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_from-nativepro_brain_to-MNI152_0.8mm_mode-image_desc-SyN_1InverseWarp.nii.gz <span class="se">\</span>
    -o <span class="si">${</span><span class="nv">Output</span><span class="si">}</span> -v
</pre></div>
</td></tr></table></div>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">From rsfMRI to T1nativepro space</span><a class="headerlink" href="#id4" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="c1"># Map from rsfMRI space to MNI152 0.8mm</span>
<span class="nv">Input</span><span class="o">=</span>file_in_space-rsfMRI.nii.gz
<span class="nv">Output</span><span class="o">=</span>file_from_rsfMRI_in_space-MNI152_0.8mm.nii.gz

antsApplyTransforms -d <span class="m">3</span> <span class="se">\</span>
    -i func/volumetric/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_space-rsfmri_desc-singleecho_brain.nii.gz <span class="se">\</span>
    -r <span class="si">${</span><span class="nv">MICAPIPE_DIR</span><span class="si">}</span>/MNI152Volumes/MNI152_T1_0.8mm_brain.nii.gz <span class="se">\</span>
    -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_from-nativepro_brain_to-MNI152_0.8mm_mode-image_desc-SyN_1Warp.nii.gz <span class="se">\</span>
    -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_from-nativepro_brain_to-MNI152_0.8mm_mode-image_desc-SyN_0GenericAffine.mat <span class="se">\</span>
    -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_rsfmri_from-rsfmri_to-nativepro_mode-image_desc-affine_0GenericAffine.mat <span class="se">\</span>
    -t <span class="o">[</span>xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_rsfmri_from-nativepro_rsfmri_to-rsfmri_mode-image_desc-SyN_0GenericAffine.mat,1<span class="o">]</span> <span class="se">\</span>
    -t xfm/<span class="si">${</span><span class="nv">subjectID</span><span class="si">}</span>_rsfmri_from-nativepro_rsfmri_to-rsfmri_mode-image_desc-SyN_1InverseWarp.nii.gz <span class="se">\</span>
    -o <span class="si">${</span><span class="nv">Output</span><span class="si">}</span> -v -u int
</pre></div>
</td></tr></table></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="surface-issues">
<h2><a class="toc-backref" href="#id12">Surface issues</a><a class="headerlink" href="#surface-issues" title="Permalink to this headline">¶</a></h2>
<dl>
<dt>Q: What if my database already has quality checked <em>Freesurfer</em> outputs?</dt><dd><p><strong>A:</strong> If you have an already processed and QC-ed freesurfer directory remember to use the flag <code class="docutils literal notranslate"><span class="pre">-freesurfer_dir</span></code> when you run the pipeline!!
It will make a copy of your data with a compatible naming inside <code class="docutils literal notranslate"><span class="pre">out/freesurfer/</span></code>. It’s up to you to keep the original <em>freesurfer</em> directory or erase it.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Usage example of -freesurfer_dir flag</span><a class="headerlink" href="#id5" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># Run micapipe</span>
 mica-pipe -bids rawdata -out derivatives -sub <span class="m">01</span> <span class="se">\</span>
       -proc_freesurfer -freesurfer_dir &lt;path_to_my_subject_freesurfer_dir&gt; <span class="se">\</span>
</pre></div>
</td></tr></table></div>
</div>
</dd>
<dt>Q: How do I modify the smoothing on the surfaces?</dt><dd><p><strong>A:</strong> By default micapipe <code class="docutils literal notranslate"><span class="pre">-Morphology</span></code> only applies a smoothing of 10mm over the surfaces.
If you need a different FWHM you can use either: <code class="docutils literal notranslate"><span class="pre">mri_surf2surf</span></code> from <em>freesurfer</em> or <code class="docutils literal notranslate"><span class="pre">wb_command</span> <span class="pre">-metric-smoothing</span></code> from <em>workbench</em>.</p>
<p>In the next examples we’ll use the subject <code class="docutils literal notranslate"><span class="pre">sub-01</span></code> session <code class="docutils literal notranslate"><span class="pre">ses-01</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">20mm smoothing of the left hemisphere using <em>freesurfer</em> tools</span><a class="headerlink" href="#id6" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># OutDir is the directory with -Morphology outpus</span>
 <span class="nv">outDir</span><span class="o">=</span>out/micapipe/sub-01/ses01/anat/surfaces/morphology

 <span class="c1"># Declare the micapipe&#39;s freesurfer directory variable</span>
 <span class="nb">export</span> <span class="nv">SUBJECTS_DIR</span><span class="o">=</span>out/freesurfer

 mri_surf2surf --hemi lh <span class="se">\</span>
     --fwhm-trg <span class="m">20</span> <span class="se">\</span>
     --srcsubject sub-01_ses01 <span class="se">\</span>
     --srcsurfval <span class="s2">&quot;</span><span class="si">${</span><span class="nv">outDir</span><span class="si">}</span><span class="s2">/sub-01_ses01_space-fsnative_desc-lh_thickness.mgh&quot;</span> <span class="se">\</span>
     --trgsubject fsaverage5 <span class="se">\</span>
     --trgsurfval <span class="s2">&quot;</span><span class="si">${</span><span class="nv">outDir</span><span class="si">}</span><span class="s2">/sub-01_ses01_space-fsaverage5_desc-lh_thickness_20mm.mgh&quot;</span>
     <span class="s2">&quot;</span><span class="si">${</span><span class="nv">outDir</span><span class="si">}</span><span class="s2">/lh_curv_20mm_c69-32k.func.gii&quot;</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">20mm smoothing of the left hemisphere using <em>WorkBench</em> tools</span><a class="headerlink" href="#id7" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre><span></span><span class="nv">MICAPIPE_DIR</span><span class="o">=</span>&lt;path to the micapipe repository&gt;

<span class="c1"># For WorkBench the first step is to convent the mgh surface file to GIFTI</span>
 mri_convert <span class="s2">&quot;</span><span class="si">${</span><span class="nv">outDir</span><span class="si">}</span><span class="s2">/sub-01_ses01_space-conte69-32k_desc-lh_thickness.mgh&quot;</span> <span class="s2">&quot;/tmp/lh_curv_c69-32k_thickness.func.gii&quot;</span>

 wb_command -metric-smoothing <span class="se">\</span>
     <span class="s2">&quot;</span><span class="si">${</span><span class="nv">MICAPIPE_DIR</span><span class="si">}</span><span class="s2">/surfaces/fsaverage.L.midthickness_orig.32k_fs_LR.surf.gii&quot;</span> <span class="se">\</span>
     <span class="s2">&quot;/tmp/lh_curv_c69-32k_thickness.func.gii&quot;</span> <span class="se">\</span>
     <span class="m">20</span> <span class="se">\</span>
     <span class="s2">&quot;/tmp/lh_curv_20mm_c69-32k.func.gii&quot;</span>     <span class="c1"># This is the 20 mm FWHM surface</span>

 <span class="c1"># Convert from GIFTI back to MGH</span>
 mri_convert <span class="s2">&quot;/tmp/lh_curv_10mm_c69-32k.func.gii&quot;</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">outDir</span><span class="si">}</span><span class="s2">/sub-01_ses01_space-conte69-32k_desc-lh_thickness_20mm.mgh&quot;</span>
</pre></div>
</td></tr></table></div>
</div>
</dd>
</dl>
</div>
<div class="section" id="resting-state-issues">
<h2><a class="toc-backref" href="#id13">Resting state issues</a><a class="headerlink" href="#resting-state-issues" title="Permalink to this headline">¶</a></h2>
<dl>
<dt>Q: How do I process multiple rsfMRI If I have different runs in the same session?</dt><dd><p><strong>A:</strong> Right now the pipeline does not manage multiple runs on the same session.
We recommend to concatenate all the runs into one file and process it.
Using <code class="docutils literal notranslate"><span class="pre">mrcat</span></code> from MRtrix3 for example:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Concatenates all rsfMRI runs and process the output</span><a class="headerlink" href="#id8" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8
9</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># Inside the func directory contatenate all the runs</span>
 mrcat sub-01_task-rest_run-1_bold.nii.gz sub-01_task-rest_run-2_bold.nii.gz sub-01_task-rest_desc-cat_bold.nii.gz

 <span class="c1"># Copy the json file from run-1</span>
 cp sub-01_task-rest_run-1_bold.json sub-01_task-rest_desc-cat_bold.json

 <span class="c1"># Run micapipe and specify the name of the concatenated rsfmri</span>
 mica-pipe -bids rawdata -out derivatives -sub <span class="m">01</span> <span class="se">\</span>
       -proc_rsfmri -mainScanStr task-rest_desc-cat_bold <span class="se">\</span>
</pre></div>
</td></tr></table></div>
</div>
</dd>
<dt>Q: Can I process multi-echo rsfMRI acquisition with micapipe?</dt><dd><p><strong>A:</strong> Although is planned to be included in a future release, right now <cite>micapipe</cite> cannot handle in any way multi-echo acquisitions.</p>
</dd>
<dt>Q: How do I train an ICA-FIX <code class="docutils literal notranslate"><span class="pre">RData</span></code> file?</dt><dd><p><strong>A:</strong> The default processing of rsfMRI was optimized with the MICs dataset. Thus, we generated a custom training file in order to use FIX with our dataset.
If you want to use FIX to clean the noisy components from your rsfMRI time series, we recommend to train your own weights file using <a class="reference external" href="https://fsl.fmrib.ox.ac.uk/fsl/fslwiki/FIX/UserGuide#Training_datasets">FSL-FIX instructions</a></p>
</dd>
<dt>Q: What if I already have rsfMRI processed data? (eg. from fmriPREP)</dt><dd><p><strong>A:</strong> Unfortunately, due to the multiple nested steps which take place inside <code class="docutils literal notranslate"><span class="pre">proc_rsfmri</span></code> is not possible to use an already processed rsfMRI volume.
If you are thrilled to develop its implementation, please help us!</p>
</dd>
<dt>Q: Why does <cite>micapipe</cite> not apply slice timing correction in rsfMRI processing?</dt><dd><p><strong>A:</strong> <cite>micapipe</cite> was optimized for multi-band acquisitions, which do not require slice timing correction.</p>
</dd>
<dt>Q: If my database has the field maps instead of the reverse phase encoding acquisition of rsfMRI and DWI, can micapipe use them for the geometric distortion correction?</dt><dd><p><strong>A:</strong> The usage of field maps is not implemented in <em>micapipe</em>.
However you could apply the field map based correction to their correspondent images and then run micapipe, choosing the fieldmap-based corrected images to process.</p>
</dd>
</dl>
</div>
<div class="section" id="dwi-issues">
<h2><a class="toc-backref" href="#id14">DWI issues</a><a class="headerlink" href="#dwi-issues" title="Permalink to this headline">¶</a></h2>
<dl>
<dt>Q: What if I already have DWI processed data?</dt><dd><p><strong>A:</strong> If you have your DWI already processed and you don’t want to run this step again. you can use the flag <code class="docutils literal notranslate"><span class="pre">-dwi_processed</span></code> to the processed DWI,
it must be in <code class="docutils literal notranslate"><span class="pre">mif</span></code> format with <em>bvals</em>, <em>bvecs</em>, <em>PhaseEncodingDirection</em> and <em>ReadoutTime</em> encoded.</p>
<div class="literal-block-wrapper docutils container" id="id9">
<div class="code-block-caption"><span class="caption-text">Usage example of -dwi_processed flag</span><a class="headerlink" href="#id9" title="Permalink to this code">¶</a></div>
<div class="highlight-bash notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># Run micapipe</span>
 mica-pipe -bids rawdata -out derivatives -sub <span class="m">01</span> <span class="se">\</span>
       -proc_dwi -dwi_processed &lt;path&gt;/dwi_preprocessed.mif <span class="se">\</span>
</pre></div>
</td></tr></table></div>
</div>
</dd>
<dt>Q: Can I save the tractogram (tck file) generated in <code class="docutils literal notranslate"><span class="pre">-SC</span></code> ?</dt><dd><p><strong>A:</strong> Yes, you need to use the flag <code class="docutils literal notranslate"><span class="pre">-keep_tck</span></code> to keep the connectome generated by the pipeline, which is erased by default.</p>
</dd>
</dl>
</div>
<div class="section" id="parcellation-issues">
<h2><a class="toc-backref" href="#id15">Parcellation issues</a><a class="headerlink" href="#parcellation-issues" title="Permalink to this headline">¶</a></h2>
<dl class="simple">
<dt>Q: Can I use a different cortical / subcortical / cerebellar atlas not included in the micapipe?</dt><dd><p><strong>A:</strong> At the present moment this feature is not included. If you wan’t to help us implementing this new feature you are very welcome.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../06.citingmicapipe/index.html" class="btn btn-neutral float-right" title="Citing micapipe" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../04.gradients/index.html" class="btn btn-neutral float-left" title="Building gradients" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, micapipe

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a 
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a> and modified by SL and RRC 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    

  <style>
         .wy-nav-content { max-width: none; }
  </style>


  <footer>
    
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a 
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. Modified by SL 🤠 

  </footer>



</body>
</html>